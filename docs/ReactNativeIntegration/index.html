<!DOCTYPE html>
<html lang=&#34;en&#34; data-theme=&#34;&#34;>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">/*<![CDATA[*/window.__chunkMapping={"main":["main.71690cdf988dc3cc3d7c.css","main.71690cdf988dc3cc3d7c.js"],"component---users-pca-github-hermes-website-src-pages-index-jse-4-e-0ed":["component---users-pca-github-hermes-website-src-pages-index-jse-4-e-0ed.3ec1b92966fb04f87afd.css","component---users-pca-github-hermes-website-src-pages-index-jse-4-e-0ed.3ec1b92966fb04f87afd.js"],"metadata---832-5a1":["metadata---832-5a1.174db707948a601971e8.js"],"component---theme-blog-post-pageccc-cab":[],"content---blog-2019-05-30-welcome-00-c-d9e":["content---blog-2019-05-30-welcome-00-c-d9e.33dd6101d655465c0734.js"],"metadata---blog-2019-05-30-welcome-00-e-176":["metadata---blog-2019-05-30-welcome-00-e-176.ef2f171118487cf88ecb.js"],"nextItem---blog-2019-05-30-welcome-0-b-2-d9f":["nextItem---blog-2019-05-30-welcome-0-b-2-d9f.c3838f4f9077ba370312.js"],"content---blog-2019-05-29-hello-world-2-c-2-d4e":["content---blog-2019-05-29-hello-world-2-c-2-d4e.3c0d779d45bc004d49c7.js"],"nextItem---blog-2019-05-29-hello-world-892-9b0":["nextItem---blog-2019-05-29-hello-world-892-9b0.509a4da9d4155f842589.js"],"content---blog-2019-05-28-hola-986-a15":["content---blog-2019-05-28-hola-986-a15.c41fdd03ab984183139e.js"],"component---theme-doc-page-1-be-9be":[],"docsMetadata---docs-96-f-459":["docsMetadata---docs-96-f-459.eea88a57a2229eba5c14.js"],"component---theme-doc-item-178-a40":[],"content---docs-building-and-runningf-5-f-f72":["content---docs-building-and-runningf-5-f-f72.2be2cfe158f59dd3ef4a.js"],"metadata---docs-building-and-running-2-e-7-aec":["metadata---docs-building-and-running-2-e-7-aec.1f1e23970058426486d5.js"],"content---docs-modules-7-aa-194":["content---docs-modules-7-aa-194.ecd01f599bf21cc2720b.js"],"metadata---docs-modules-568-6e2":["metadata---docs-modules-568-6e2.e2e15f9683028de1b856.js"],"content---docs-coding-standards-69-e-28a":["content---docs-coding-standards-69-e-28a.7b5fc9c91887ec9c8ca4.js"],"metadata---docs-coding-standardscdf-f10":["metadata---docs-coding-standardscdf-f10.73c4859c845db96a02a6.js"],"content---docs-featuresffe-991":["content---docs-featuresffe-991.baa9aaebfc1c5f132c73.js"],"metadata---docs-features-558-69b":["metadata---docs-features-558-69b.840690062d226342beec.js"],"content---docs-optimizer-7-a-9-a4c":["content---docs-optimizer-7-a-9-a4c.f5d2442ad6823069e60c.js"],"metadata---docs-optimizer-682-a9e":["metadata---docs-optimizer-682-a9e.c8afe54580d96b526a53.js"],"content---docs-react-native-integrationd-31-486":["content---docs-react-native-integrationd-31-486.9d0696f55ced5ab061ea.js"],"metadata---docs-react-native-integration-083-b97":["metadata---docs-react-native-integration-083-b97.40f374553383f741d221.js"],"content---docs-vmc-44-de9":["content---docs-vmc-44-de9.a6444390252a67a14823.js"],"metadata---docs-vm-91-c-2d7":["metadata---docs-vm-91-c-2d7.271c593fa0df84fc8f61.js"],"content---docs-design-876-b60":["content---docs-design-876-b60.c4fd7caa194aaf147cd0.js"],"metadata---docs-design-297-3f3":["metadata---docs-design-297-3f3.73e7c4b90d090a139115.js"],"content---docs-strings-1-f-1-063":["content---docs-strings-1-f-1-063.9d0e60a57c8420f4116d.js"],"metadata---docs-stringse-6-c-887":["metadata---docs-stringse-6-c-887.0852dede0bc26f4b8d89.js"],"content---docs-irfac-7ea":["content---docs-irfac-7ea.d0fe789815a3347256b0.js"],"metadata---docs-ir-1-a-3-52f":["metadata---docs-ir-1-a-3-52f.bf8e8518122779e3491c.js"],"component---theme-blog-list-pagea-6-a-7ba":[],"content---blog-660-ca1":["content---blog-660-ca1.a0b0944234e47373c223.js"],"content---blog-341-9fb":["content---blog-341-9fb.dc4f2e90c05ed08475e7.js"],"content---blog-5-a-2-af2":["content---blog-5-a-2-af2.cdd78b45f182e4ea815f.js"],"metadata---blog-8-a-9-3b4":["metadata---blog-8-a-9-3b4.a5800579197ec44df1b3.js"],"component---theme-blog-tags-posts-page-687-b6c":[],"metadata---blog-tags-docusaurus-88-e-ec6":["metadata---blog-tags-docusaurus-88-e-ec6.ddec69e0e45795e209f4.js"],"metadata---blog-tags-facebook-3-dc-2a7":["metadata---blog-tags-facebook-3-dc-2a7.14274f9d18db526d0760.js"],"metadata---blog-tags-hola-16-c-449":["metadata---blog-tags-hola-16-c-449.c0619b9ecd018c113e6a.js"],"metadata---blog-tags-hello-5-e-9-a6f":["metadata---blog-tags-hello-5-e-9-a6f.ac44553b03d7435aad21.js"],"component---theme-blog-tags-list-page-01-a-d0b":[],"tags---blog-tags-090-dbe":["tags---blog-tags-090-dbe.9b54e78f07c702d985ff.js"]};/*]]>*/</script><title data-react-helmet="true">ReactNativeIntegration</title><meta data-react-helmet="true" name="description" content="# Using a custom Hermes build in a React Native app"/><meta data-react-helmet="true" property="og:description" content="# Using a custom Hermes build in a React Native app"/><link data-react-helmet="true" rel="shortcut icon" href="img/favicon.ico"/><link rel="stylesheet" type="text/css" href="main.71690cdf988dc3cc3d7c.css" />
<link rel="stylesheet" type="text/css" href="component---users-pca-github-hermes-website-src-pages-index-jse-4-e-0ed.3ec1b92966fb04f87afd.css" />
<link rel="stylesheet" type="text/css" href="docusaurus.f92c01d92a44b700cc3d.css" />
</head>
<body >
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a aria-current="page" class="navbar__brand active" href="/"><img class="navbar__logo" src="img/logo.svg" alt="Hermes Logo"/><strong>Hermes</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="https://github.com/facebook/hermes" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_1gtMWLzW"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_16vChPFo moon_1N64xB5S"></span></div><div class="react-toggle-track-x"><span class="toggle_16vChPFo sun_3CZP6R61"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"/></div></div></div><div role="presentation" class="navbar__sidebar__backdrop"></div><div class="navbar__sidebar"><div class="navbar__sidebar__brand"><a class="navbar__brand" href="#!" role="button"><img class="navbar__logo" src="img/logo.svg" alt="Hermes Logo"/><strong>Hermes</strong></a></div><div class="navbar__sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="https://github.com/facebook/hermes" label="GitHub" position="right" target="_blank" rel="noopener noreferrer">GitHub</a></li></ul></div></div></div></nav><div class="container container--fluid"><div class="row"><div class="col col--3"></div><main class="col"><div><div class="padding-vert--lg"><div class="row"><div class="col"><div class="docItemContainer_2cwgKB16"><header><h1 class="margin-bottom--lg">ReactNativeIntegration</h1></header><article><div class="markdown"><h1><a aria-hidden="true" class="anchor" id="using-a-custom-hermes-build-in-a-react-native-app"></a><a aria-hidden="true" class="hash-link" href="#using-a-custom-hermes-build-in-a-react-native-app">#</a>Using a custom Hermes build in a React Native app</h1><p>To make Hermes usable in a React Native app we need to perform the following steps:</p><ol><li>Package a Hermes build into an npm package structure.</li><li>Register this npm package with Yarn for use in other local projects.</li><li>Link the npm package registered with Yarn into the React Native tree for our app.</li></ol><h2><a aria-hidden="true" class="anchor" id="making-a-hermes-npm-package"></a><a aria-hidden="true" class="hash-link" href="#making-a-hermes-npm-package">#</a>Making a Hermes npm package</h2><p>A Hermes npm package combines:</p><ul><li>Hermes CLI tools in binary form. These are used to compile JavaScript to bytecode when packaging up an app release.</li><li>Pre-compiled release and debug versions of the native Hermes library for Android targets.</li></ul><h3><a aria-hidden="true" class="anchor" id="dependencies"></a><a aria-hidden="true" class="hash-link" href="#dependencies">#</a>Dependencies</h3><p>As we will be compiling native libraries for Android, we first need to setup a suitable development environment. This subject is covered in more detail elsewhere, for example in the guide on <a href="https://github.com/facebook/react-native/wiki/Building-from-source">building React Native From Source</a>. However, a rough guide to the external dependencies for macOS/Linux is as follows:</p><ul><li>Node.js</li><li>Gradle (version 4.10.1+)</li><li>JDK (1.8+)</li><li>Yarn</li><li>The Android Native Development Kit (NDK)</li><li>The Android Software Development Kit (SDK)</li></ul><p>Note the Android SDK is typically downloaded and installed automatically as part of the flow in Android Studio. If you are following this common route, be sure to note the location Android Studio uses to install the SDK.</p><h3><a aria-hidden="true" class="anchor" id="build-environment"></a><a aria-hidden="true" class="hash-link" href="#build-environment">#</a>Build environment</h3><p>Ensure the following variables are present and set correctly in your environment:</p><ul><li><code>ANDROID_NDK</code> - the root of your Android NDK install. E.g. &quot;/opt/android_ndk/r15c&quot;.</li><li><code>ANDROID_SDK</code>, <code>ANDROID_HOME</code>, and <code>ANDROID_SDK_ROOT</code> - the root of your Android SDK install. E.g. &quot;/opt/android_sdk&quot;.</li><li><code>JAVA_HOME</code> - the root of your Java Runtime Envrionment (JRE) install. Note a JRE instance is typically available in a sub-directory of a JDK install. E.g. &quot;/opt/jdk-1.8/jre&quot;.</li><li><code>HERMES_WS_DIR</code> - the same workspace used to make a build Hermes CLI tools.</li></ul><p>Make sure the <code>node</code>, <code>yarn</code>, and <code>gradle</code> binaries are available in your system PATH.</p><h3><a aria-hidden="true" class="anchor" id="package-build"></a><a aria-hidden="true" class="hash-link" href="#package-build">#</a>Package build</h3><p>To make a Hermes npm package, first follow the instructions on <a href="doc/BuildingAndRunning.md">building Hermes</a> to create a <strong>release</strong> version of Hermes. This will be the source of CLI binaries for use in the npm.</p><p>Next, we need to cross-compile LLVM for various different Android targets. This step only needs to be run once, and may take quite some time:</p><pre class="mdxCodeBlock_iHAB0Zg7"><pre class="prism-code language-shell codeBlock_19pQyIiL" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> ./hermes/utils/crosscompile_llvm.sh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre></pre><p>Once cross-compiled LLVM is built we can build Hermes libraries for various Android platforms, and package everything together:</p><pre class="mdxCodeBlock_iHAB0Zg7"><pre class="prism-code language-shell codeBlock_19pQyIiL" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/build_release </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> ninja github-cli-release</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/hermes/android </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> gradle githubRelease</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/build_android/distributions/hermes-runtime-android-v*.tar.gz </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/hermes/npm</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/build_release/github/hermes-cli-*-v*.tar.gz </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/hermes/npm</span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/hermes/npm </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> yarn </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> yarn run prepack-dev</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$HERMES_WS_DIR</span><span class="token plain">/hermes/npm </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> yarn link</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre></pre><p>The final <code>yarn link</code> command in this sequence registers your custom build of Hermes to Yarn for inclusion in local projects. It only needs to be run once, although running it again is benign.</p><h2><a aria-hidden="true" class="anchor" id="linking-hermes-into-a-react-native-app"></a><a aria-hidden="true" class="hash-link" href="#linking-hermes-into-a-react-native-app">#</a>Linking Hermes into a React Native app</h2><p>To use your custom Hermes npm package in an app, first make sure the app works with a normal release of Hermes by following <a href="https://facebook.github.io/react-native/docs/hermes">instructions in the React Native docs</a>.</p><p>Next, link the Hermes npm package into the React Native package in your app. For example, assuming your project is in the directory <code>$AWESOME_PROJECT</code> you would run this command:</p><pre class="mdxCodeBlock_iHAB0Zg7"><pre class="prism-code language-shell codeBlock_19pQyIiL" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cd </span><span class="token variable" style="color:rgb(214, 222, 235)">$AWESOME_PROJECT</span><span class="token plain">/node_modules/react-native </span><span class="token operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token plain"> yarn </span><span class="token function" style="color:rgb(130, 170, 255)">link</span><span class="token plain"> hermesvm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></pre></pre><p>You can now develop your app in the normal way.</p><p>Note: if you are making changes to the compiler in Hermes, be sure to make sure you test your app in release mode as this enables bytecode compilation in advance.</p></div></article><div class="margin-top--xl margin-bottom--lg"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNYj2De"><ul class="contents contents__left-border"><li><a href="#making-a-hermes-npm-package" class="contents__link">Making a Hermes npm package</a><ul class=""><li><a href="#dependencies" class="contents__link">Dependencies</a></li><li><a href="#build-environment" class="contents__link">Build environment</a></li><li><a href="#package-build" class="contents__link">Package build</a></li></ul></li><li><a href="#linking-hermes-into-a-react-native-app" class="contents__link">Linking Hermes into a React Native app</a></li></ul></div></div></div></div></div></main></div></div></div>
<script type="text/javascript" src="/runtime~main.226376db23de8d5acb39.js"></script>
<script type="text/javascript" src="main.71690cdf988dc3cc3d7c.js"></script>
<script type="text/javascript" src="vendors.e4e011503d47601f3e5c.js"></script>
<script type="text/javascript" src="react-helmet.082c2b7a403549d4d09f.js"></script>
<script type="text/javascript" src="prism-react-renderer.738854e9c28f5bafcbc3.js"></script>
<script type="text/javascript" src="component---users-pca-github-hermes-website-src-pages-index-jse-4-e-0ed.3ec1b92966fb04f87afd.js"></script>
<script type="text/javascript" src="docusaurus.f92c01d92a44b700cc3d.js"></script>
<script type="text/javascript" src="docsMetadata---docs-96-f-459.eea88a57a2229eba5c14.js"></script>
<script type="text/javascript" src="content---docs-react-native-integrationd-31-486.9d0696f55ced5ab061ea.js"></script>
<script type="text/javascript" src="metadata---docs-react-native-integration-083-b97.40f374553383f741d221.js"></script>
</body>
</html>